<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Input Form Example</title>
    <style>
        body { font-family: "Segoe UI", Arial, sans-serif; background: #f8f8f8; }
        h1 { margin-bottom: 10px; }
        form { background: #fff; padding: 20px; border-radius: 8px; box-shadow: 0 2px 8px #ccc; max-width: 800px; margin-bottom: 20px; }
        label { display: inline-block; width: 140px; margin-bottom: 6px; vertical-align: top; }
        input[type="text"] { width: 180px; padding: 4px; margin-bottom: 6px; }
        fieldset { margin-bottom: 12px; border-radius: 6px; background: #f3f3f3; }
        legend { font-weight: bold; }
        .row { display: flex; flex-wrap: wrap; gap: 10px; margin-bottom: 8px; }
        .row label, .row input { margin-bottom: 0; }
        input[type="submit"] { padding: 8px 24px; font-size: 16px; border-radius: 4px; border: 1px solid #888; background: #4caf50; color: #fff; cursor: pointer; }
        input[type="submit"]:hover { background: #388e3c; }
        table { border-collapse: collapse; background: #fff; margin-top: 10px; }
        th, td { padding: 6px 10px; border: 1px solid #bbb; }
        th { background: #e0e0e0; }
        tr:nth-child(even) { background: #f9f9f9; }
    </style>
</head>
<body>
    
    <form id="mainForm">
        <h3 style="text-align:center;">AOD</h3>
        <div class="row">
            <label for="department">部門:</label>
            <input type="text" id="department" name="department">
            <label for="pcname">PC名:</label>
            <input type="text" id="pcname" name="pcname">
            <label for="win">WIN(OS):</label>
            <input type="text" id="win" name="win">
        </div>
        <fieldset>
            <legend>PC information</legend>
            <div class="row">
                <label for="pc_ip">IP:</label>
                <input type="text" id="pc_ip" name="pc_ip">
                <label for="pc_hdd">HDD SIZE:</label>
                <input type="text" id="pc_hdd" name="pc_hdd">
                <label for="pc_ram">RAM:</label>
                <input type="text" id="pc_ram" name="pc_ram">
            </div>
        </fieldset>
        <fieldset>
            <legend>PC機身</legend>
            <div class="row">
                <label for="pcbody_model">型號:</label>
                <input type="text" id="pcbody_model" name="pcbody_model">
                <label for="pcbody_pcom">PCOM:</label>
                <input type="text" id="pcbody_pcom" name="pcbody_pcom">
                <label for="pcbody_camcode">CAMCODE:</label>
                <input type="text" id="pcbody_camcode" name="pcbody_camcode">
                <label for="pcbody_sn">S/N:</label>
                <input type="text" id="pcbody_sn" name="pcbody_sn">
            </div>
        </fieldset>
        <fieldset>
            <legend>MON1</legend>
            <div class="row">
                <label for="mon1_model">MON MODEL:</label>
                <input type="text" id="mon1_model" name="mon1_model">
                <label for="mon1_size">SIZE:</label>
                <input type="text" id="mon1_size" name="mon1_size">
                <label for="mon1_pcom">PCOM:</label>
                <input type="text" id="mon1_pcom" name="mon1_pcom">
                <label for="mon1_camcode">CAM CODE:</label>
                <input type="text" id="mon1_camcode" name="mon1_camcode">
                <label for="mon1_sn">SN:</label>
                <input type="text" id="mon1_sn" name="mon1_sn">
            </div>
        </fieldset>
        <fieldset>
            <legend>MON2</legend>
            <div class="row">
                <label for="mon2_model">MON MODEL:</label>
                <input type="text" id="mon2_model" name="mon2_model">
                <label for="mon2_size">SIZE:</label>
                <input type="text" id="mon2_size" name="mon2_size">
                <label for="mon2_pcom">PCOM:</label>
                <input type="text" id="mon2_pcom" name="mon2_pcom">
                <label for="mon2_camcode">CAM CODE:</label>
                <input type="text" id="mon2_camcode" name="mon2_camcode">
                <label for="mon2_sn">SN:</label>
                <input type="text" id="mon2_sn" name="mon2_sn">
            </div>
        </fieldset>
        <input type="submit" value="Submit">
    </form>
    <hr>
    <h2>已輸入資料</h2>
    <div id="dataTable"></div>
    <script>
        const form = document.getElementById('mainForm');
        const dataTable = document.getElementById('dataTable');
        let records = [];
        let editIndex = null;

        // 讀取 localStorage
        if (localStorage.getItem('records')) {
            try {
                records = JSON.parse(localStorage.getItem('records')) || [];
            } catch(e) {
                records = [];
            }
        }
        renderTable();

        form.addEventListener('submit', function(e) {
            e.preventDefault();
            const formData = new FormData(form);
            let record = {};
            formData.forEach((value, key) => {
                record[key] = value;
            });
            if (editIndex !== null) {
                records[editIndex] = record;
                editIndex = null;
            } else {
                records.push(record);
            }
            localStorage.setItem('records', JSON.stringify(records));
            form.reset();
            renderTable();
        });

        function renderTable() {
            if (records.length === 0) {
                dataTable.innerHTML = '<i>尚未有資料</i>';
                return;
            }
            let html = '<table border="1" cellpadding="5"><thead><tr>';
            const headers = [
                '部門','PC名','WIN(OS)',
                'PC IP','PC HDD SIZE','PC RAM',
                'PC機身(型號)','PC機身PCOM','PC機身CAMCODE','PC機身S/N',
                'MON1 MODEL','MON1 SIZE','MON1 PCOM','MON1 CAM CODE','MON1 SN',
                'MON2 MODEL','MON2 SIZE','MON2 PCOM','MON2 CAM CODE','MON2 SN',
                '操作'
            ];
            html += headers.map(h => `<th>${h}</th>`).join('') + '</tr></thead><tbody>';
            records.forEach((r, idx) => {
                html += '<tr>' +
                    `<td>${r.department||''}</td>`+
                    `<td>${r.pcname||''}</td>`+
                    `<td>${r.win||''}</td>`+
                    `<td>${r.pc_ip||''}</td>`+
                    `<td>${r.pc_hdd||''}</td>`+
                    `<td>${r.pc_ram||''}</td>`+
                    `<td>${r.pcbody_model||''}</td>`+
                    `<td>${r.pcbody_pcom||''}</td>`+
                    `<td>${r.pcbody_camcode||''}</td>`+
                    `<td>${r.pcbody_sn||''}</td>`+
                    `<td>${r.mon1_model||''}</td>`+
                    `<td>${r.mon1_size||''}</td>`+
                    `<td>${r.mon1_pcom||''}</td>`+
                    `<td>${r.mon1_camcode||''}</td>`+
                    `<td>${r.mon1_sn||''}</td>`+
                    `<td>${r.mon2_model||''}</td>`+
                    `<td>${r.mon2_size||''}</td>`+
                    `<td>${r.mon2_pcom||''}</td>`+
                    `<td>${r.mon2_camcode||''}</td>`+
                    `<td>${r.mon2_sn||''}</td>`+
                    `<td><button type="button" onclick="editRecord(${idx})">修改</button></td>`+
                    '</tr>';
            });
            html += '</tbody></table>';
            dataTable.innerHTML = html;
            // 每次渲染都同步 localStorage
            localStorage.setItem('records', JSON.stringify(records));
        }

        window.editRecord = function(idx) {
            const r = records[idx];
            for (const key in r) {
                if (form.elements[key]) {
                    form.elements[key].value = r[key];
                }
            }
            editIndex = idx;
            form.scrollIntoView({behavior: 'smooth'});
        }
    </script>
</body>
</html>